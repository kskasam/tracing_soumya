<!DOCTYPE html>
<html>
<head>
    <title>Telugu Coordinate Debug</title>
    <style>
        body {
            font-family: monospace;
            padding: 20px;
            background: #f5f5f5;
        }
        .result {
            background: white;
            padding: 20px;
            margin: 10px 0;
            border-radius: 5px;
            border-left: 4px solid #4CAF50;
        }
        .error {
            border-left-color: #f44336;
        }
        h2 {
            color: #333;
        }
        pre {
            background: #263238;
            color: #aed581;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
        }
    </style>
</head>
<body>
    <h1>Telugu 'అ' Coordinate Transformation Debug</h1>
    
    <div class="result">
        <h2>SVG Path Bounding Box</h2>
        <pre id="bbox"></pre>
    </div>
    
    <div class="result">
        <h2>Flutter Transformation Calculation</h2>
        <pre id="transform"></pre>
    </div>
    
    <div class="result">
        <h2>Example Point Transformation</h2>
        <pre id="example"></pre>
    </div>
    
    <div class="result">
        <h2>Your JSON First Point</h2>
        <pre id="jsonpoint"></pre>
    </div>
    
    <div class="result" id="verdict">
        <h2>Verdict</h2>
        <pre id="verdicttext"></pre>
    </div>

    <script>
        // Telugu 'అ' SVG path bounds (from extract script)
        const svgBBox = {
            x: 100,
            y: 302.05,
            width: 747.69,
            height: 525.13
        };
        
        const viewSize = { width: 200, height: 200 };
        
        // Calculate Flutter's transformation
        const scaleX = viewSize.width / svgBBox.width;
        const scaleY = viewSize.height / svgBBox.height;
        const scale = Math.min(scaleX, scaleY);
        
        const translateX = (viewSize.width - svgBBox.width * scale) / 2 - svgBBox.x * scale;
        const translateY = (viewSize.height - svgBBox.height * scale) / 2 - svgBBox.y * scale;
        
        document.getElementById('bbox').textContent = `x: ${svgBBox.x}
y: ${svgBBox.y}
width: ${svgBBox.width}
height: ${svgBBox.height}
aspect ratio: ${(svgBBox.width / svgBBox.height).toFixed(4)} (wider than tall)`;
        
        document.getElementById('transform').textContent = `scaleX: ${scaleX.toFixed(6)} (200 / ${svgBBox.width})
scaleY: ${scaleY.toFixed(6)} (200 / ${svgBBox.height})
scale (uniform): ${scale.toFixed(6)} = min(scaleX, scaleY)

translateX: ${translateX.toFixed(4)}
  = (200 - ${svgBBox.width} * ${scale.toFixed(4)}) / 2 - ${svgBBox.x} * ${scale.toFixed(4)}
  = (200 - ${(svgBBox.width * scale).toFixed(2)}) / 2 - ${(svgBBox.x * scale).toFixed(2)}
  = ${((viewSize.width - svgBBox.width * scale) / 2).toFixed(2)} - ${(svgBBox.x * scale).toFixed(2)}
  
translateY: ${translateY.toFixed(4)}
  = (200 - ${svgBBox.height} * ${scale.toFixed(4)}) / 2 - ${svgBBox.y} * ${scale.toFixed(4)}
  = (200 - ${(svgBBox.height * scale).toFixed(2)}) / 2 - ${(svgBBox.y * scale).toFixed(2)}
  = ${((viewSize.height - svgBBox.height * scale) / 2).toFixed(2)} - ${(svgBBox.y * scale).toFixed(2)}`;
        
        // Example: First point in your trace should be around SVG (185.13, 477.44)
        // This is the bottom-left of the left circle
        const exampleSVG = { x: 185.13, y: 477.44 };
        const exampleTransformed = {
            x: exampleSVG.x * scale + translateX,
            y: exampleSVG.y * scale + translateY
        };
        const exampleNormalized = {
            x: exampleTransformed.x / viewSize.width,
            y: exampleTransformed.y / viewSize.height
        };
        
        document.getElementById('example').textContent = `SVG point (bottom-left of left circle): (${exampleSVG.x}, ${exampleSVG.y})

After Flutter transformation:
  x = ${exampleSVG.x} * ${scale.toFixed(4)} + ${translateX.toFixed(4)} = ${exampleTransformed.x.toFixed(4)}
  y = ${exampleSVG.y} * ${scale.toFixed(4)} + ${translateY.toFixed(4)} = ${exampleTransformed.y.toFixed(4)}
  
Normalized (divide by 200):
  x = ${exampleTransformed.x.toFixed(4)} / 200 = ${exampleNormalized.x.toFixed(4)}
  y = ${exampleTransformed.y.toFixed(4)} / 200 = ${exampleNormalized.y.toFixed(4)}
  
This is what should be in JSON for this point!`;
        
        // Your JSON first point
        const jsonPoint = { x: 0.1514, y: 0.4994 };
        const jsonInFlutterSpace = {
            x: jsonPoint.x * 200,
            y: jsonPoint.y * 200
        };
        
        document.getElementById('jsonpoint').textContent = `JSON: (${jsonPoint.x}, ${jsonPoint.y})
Multiplied by 200: (${jsonInFlutterSpace.x.toFixed(2)}, ${jsonInFlutterSpace.y.toFixed(2)})`;
        
        // Verdict
        const diff = {
            x: Math.abs(exampleNormalized.x - jsonPoint.x),
            y: Math.abs(exampleNormalized.y - jsonPoint.y)
        };
        
        const isCorrect = diff.x < 0.05 && diff.y < 0.05;
        const verdictDiv = document.getElementById('verdict');
        verdictDiv.className = 'result ' + (isCorrect ? '' : 'error');
        
        document.getElementById('verdicttext').textContent = `Difference between expected and actual:
  ΔX: ${diff.x.toFixed(4)} ${diff.x < 0.05 ? '✓' : '✗ TOO LARGE'}
  ΔY: ${diff.y.toFixed(4)} ${diff.y < 0.05 ? '✓' : '✗ TOO LARGE'}
  
${isCorrect ? '✓ JSON coordinates look correct!' : '✗ JSON coordinates DON\'T match Flutter transformation!'}

Expected first point: (${exampleNormalized.x.toFixed(4)}, ${exampleNormalized.y.toFixed(4)})
Actual JSON first point: (${jsonPoint.x}, ${jsonPoint.y})

${!isCorrect ? 'The HTML tool is generating WRONG coordinates!' : ''}`;
    </script>
</body>
</html>
